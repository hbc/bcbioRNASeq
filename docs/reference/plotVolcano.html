<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot Volcano — plotVolcano • bcbioRNASeq</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Plot Volcano — plotVolcano" />

<meta property="og:description" content="Plot Volcano" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bcbioRNASeq</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hbc/bcbioRNASeq">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Volcano</h1>
    <small class="dont-index">Source: <a href='https://github.com/hbc/bcbioRNASeq/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/hbc/bcbioRNASeq/blob/master/R/plotVolcano-methods.R'><code>R/plotVolcano-methods.R</code></a></small>
    <div class="hidden name"><code>plotVolcano.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Plot Volcano</p>
    
    </div>

    <pre class="usage"><span class='fu'>plotVolcano</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for DESeqResults</span>
<span class='fu'>plotVolcano</span>(<span class='no'>object</span>, <span class='no'>alpha</span>, <span class='kw'>lfcThreshold</span> <span class='kw'>=</span> <span class='fl'>0L</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>, <span class='kw'>genes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>gene2symbol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ntop</span> <span class='kw'>=</span> <span class='fl'>0L</span>,
  <span class='kw'>direction</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"up"</span>, <span class='st'>"down"</span>), <span class='kw'>pointColor</span> <span class='kw'>=</span> <span class='st'>"gray50"</span>,
  <span class='kw'>sigPointColor</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>upregulated</span> <span class='kw'>=</span> <span class='st'>"purple"</span>, <span class='kw'>downregulated</span> <span class='kw'>=</span> <span class='st'>"orange"</span>),
  <span class='kw'>histograms</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>return</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"ggplot"</span>, <span class='st'>"data.frame"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Passthrough arguments to <code><a href='http://www.rdocumentation.org/packages/pheatmap/topics/pheatmap'>pheatmap::pheatmap()</a></code>. The names of the
arguments should be formatted in camel case, not snake case.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Adjusted P value ("alpha") cutoff.</p></td>
    </tr>
    <tr>
      <th>lfcThreshold</th>
      <td><p>Log fold change ratio (base 2) cutoff threshold.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>Upper boundary limit for y-axis. Helps preserve dynamic range
for gene sets containing highly significant P values (e.g. <code>1e-100</code>).</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>Character vector of genes to include. These must match the
rownames of the object. It is best practice to use the stable gene
identifiers from Ensembl (e.g. "ENSG00000000003") and not the gene symbols.</p></td>
    </tr>
    <tr>
      <th>gene2symbol</th>
      <td><p><code>data.frame</code> containing gene-to-symbol mappings. Must
contain the columns <code>geneID</code> and <code>geneName</code>.</p></td>
    </tr>
    <tr>
      <th>ntop</th>
      <td><p>Number of top genes to label.</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>Plot "<code>both</code>", "<code>up</code>", or "<code>down</code>" directions.</p></td>
    </tr>
    <tr>
      <th>pointColor</th>
      <td><p>Default point color for the plot.</p></td>
    </tr>
    <tr>
      <th>sigPointColor</th>
      <td><p><code>character</code> vector containing color names for labeling
upregulated and downregulated genes. Also supports a character string for
labeling DEGs with the same color, regardless of direction.</p></td>
    </tr>
    <tr>
      <th>histograms</th>
      <td><p>Show LFC and P value histograms.</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>Object class to return. Uses <code>match.arg()</code> internally and picks
the first item in the vector by default.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>ggplot</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>This function is an updated variant of
<code>CHBUtils::volcano_density_plot()</code>.</p>
<p>Other Differential Expression Functions: <code>alphaSummary</code>,
  <code>contrastName</code>, <code>plotDEGHeatmap</code>,
  <code>plotDEGPCA</code>, <code><a href='plotMA.html'>plotMeanAverage</a></code>,
  <code>resultsTables</code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>gene2symbol</span> <span class='kw'>&lt;-</span> <span class='fu'>gene2symbol</span>(<span class='no'>bcb_small</span>)

<span class='co'># DESeqResults ====</span>
<span class='co'># Color DEGs in each direction separately</span>
<span class='fu'>plotVolcano</span>(
    <span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>res_small</span>,
    <span class='kw'>sigPointColor</span> <span class='kw'>=</span> <span class='fu'>c</span>(
        <span class='kw'>upregulated</span> <span class='kw'>=</span> <span class='st'>"purple"</span>,
        <span class='kw'>downregulated</span> <span class='kw'>=</span> <span class='st'>"orange"</span>
    )
)</div><div class='img'><img src='plotVolcano-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Label DEGs with a single color</span>
<span class='fu'>plotVolcano</span>(<span class='no'>res_small</span>, <span class='kw'>sigPointColor</span> <span class='kw'>=</span> <span class='st'>"purple"</span>)</div><div class='img'><img src='plotVolcano-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Directional support</span>
<span class='fu'>plotVolcano</span>(
    <span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>res_small</span>,
    <span class='kw'>direction</span> <span class='kw'>=</span> <span class='st'>"up"</span>,
    <span class='kw'>ntop</span> <span class='kw'>=</span> <span class='fl'>5L</span>,
    <span class='kw'>gene2symbol</span> <span class='kw'>=</span> <span class='no'>gene2symbol</span>,
    <span class='kw'>histograms</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='img'><img src='plotVolcano-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plotVolcano</span>(
    <span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>res_small</span>,
    <span class='kw'>direction</span> <span class='kw'>=</span> <span class='st'>"down"</span>,
    <span class='kw'>ntop</span> <span class='kw'>=</span> <span class='fl'>5L</span>,
    <span class='kw'>gene2symbol</span> <span class='kw'>=</span> <span class='no'>gene2symbol</span>,
    <span class='kw'>histograms</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='img'><img src='plotVolcano-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Return coordinates as a data.frame</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>plotVolcano</span>(<span class='no'>res_small</span>, <span class='kw'>return</span> <span class='kw'>=</span> <span class='st'>"data.frame"</span>)
<span class='fu'>glimpse</span>(<span class='no'>x</span>)</div><div class='output co'>#&gt; Observations: 494
#&gt; Variables: 7
#&gt; $ baseMean       &lt;dbl&gt; 12562.2432, 1079.2175, 69339.5105, 2368.9417, 3560.1...
#&gt; $ log2FoldChange &lt;dbl&gt; 8.271501, 5.897090, 5.355191, 4.539434, 4.079583, 3....
#&gt; $ padj           &lt;dbl&gt; 3.887927e-194, 8.785910e-33, 9.026988e-76, 6.412006e...
#&gt; $ negLog10Padj   &lt;dbl&gt; 10.000000, 10.000000, 10.000000, 10.000000, 10.00000...
#&gt; $ rankScore      &lt;dbl&gt; 82.71501, 58.97090, 53.55191, 45.39434, 40.79583, 37...
#&gt; $ rank           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1...
#&gt; $ isDE           &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, 1,...</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
John Hutchinson, Michael Steinbaugh, Lorena Pantano

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://steinbaugh.com'>Michael Steinbaugh</a>, <a href='https://lpantano.github.io'>Lorena Pantano</a>, <a href='https://github.com/roryk'>Rory Kirchner</a>, <a href='https://github.com/vbarrera'>Victor Barrera</a>, <a href='https://github.com/chapmanb'>Brad Chapman</a>, <a href='https://github.com/marypiper'>Mary Piper</a>, <a href='https://github.com/mistrm82'>Meeta Mistry</a>, <a href='https://github.com/rkhetani'>Radhika Khetani</a>, <a href='https://github.com/KayleighRutherford'>Kayleigh Rutherford</a>, <a href='https://github.com/ohofmann'>Oliver Hofmann</a>, <a href='https://github.com/jnhutchinson'>John Hutchinson</a>, <a href='https://github.com/sjhosui'>Shannan Ho Sui</a>, <a href='http://bioinformatics.sph.harvard.edu'>Harvard Chan Bioinformatics Core</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

