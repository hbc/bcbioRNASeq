---
title: "Small RNA-Seq Quality Control"
author: "`r getOption('author')`"
date: "`r Sys.Date()`"
bibliography: bcbioRnaseq.bib
params:
    bcb: "data/bcb.rda"
    outputDir: "."
---

```{r setup, include=FALSE}
bcbioRnaseq::download()
source("setup.R")
library(isomiRs)

# bcbioRNADataSet
# Need to save bcb using `loadRun()` prior to knit!
bcbName <- load(params$bcb)
assign("bcb", get(bcbName))
if (is.null(bcb)) stop("bcbioRNADataSet missing")

# Directory paths
outputDir <- normalizePath(params$outputDir)
dataDir <- file.path(outputDir, "data")
countsDir <- file.path(outputDir, "results", "counts")
```

```{r header, child="_header.Rmd"}
```



# Exploratory analysis

In this section we will see descriptive figures about quality of the data, reads with adapter, reads mapped to miRNAs, reads mapped to other small RNAs.


## Size distribution

After adapter removal, we can plot the size distribution of the small RNAs.

```{r adapter}
plotSizeDistribution(bcb)
```


## miRNA

### Total miRNA expression annotated with mirbase

```{r plotMicroRNACounts, fig.height=9}
plotMicroRNACounts(bcb)
```

```{r plotSmallRNAClusters}
plotSmallRNAClusters(bcb)
```

### isomiRs

```{r isomiRs, eval=ismirbase}
ids <- bcbio(bcb, "isomirs")
isoPlot(ids, type = "all", column = "group")
```



```{r footer, child="_footer.Rmd"}
```
